<!DOCTYPE html>
<html charset="utf-8"><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	
<head>
  <title>HIV Rate by State</title>


<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<style type="text/css">
		
		.bar{
			fill: steelblue;
			stroke: none;
		}

		.axis text{

  			font-family: Helvetica, Arial, sans-serif;
  			font-size: 10px;

		}
		.axis path{
			fill:none;
			stroke:black;
 	 		stroke-width: 1.5px;
		}


</style>



</head>
<body>


<script type="text/javascript">
	
var data = [
   {name:"Alabama",  value: 17.43},
   {name:"Alaska" ,  value: 3.74},
   {name:"Arizona", value: 10.92},
   {name:"Arkansas", value: 8.27},
   {name:"California",  value: 15.83},
   {name:"Colorado" ,  value: 7.90},
   {name:"Connecticut", value: 12.01},
   {name:"Delaware", value: 14.00},
   {name:"Discrict of Columbia",  value: 155.18},
   {name:"Florida" ,  value: 28.30},
   {name:"Georgia", value: 25.67},
   {name:"Hawaii", value: 5.67},
   {name:"Idaho",  value: 2.40},
   {name:"Illinois",  value: 16.61},
   {name:"Indiana", value: 7.86},
   {name:"Iowa", value: 4.18}, 
   {name:"Kansas",  value: 5.08},
   {name:"Kentucky",  value: 7.83},
   {name:"Louisiana",  value: 30.08},
   {name:"Maine" ,  value: 4.44},
   {name:"Maryland", value: 30.39},
   {name:"Massachusetts", value: 19.16},
   {name:"Michigan",  value: 8.03},
   {name:"Minnesota",  value: 5.95},
   {name:"Mississippi", value: 20.72},
   {name:"Missouri", value: 9.35},
   {name:"Montana",  value: 2.20},
   {name:"Nebraska",  value: 4.18},
   {name:"Nevada",  value: 14.61},
   {name:"New Hampshire", value: 3.87},
   {name:"New Jersey", value: 17.65},
   {name:"New Mexico",  value: 7.01},
   {name:"New York",  value: 25.40},
   {name:"North Carolina",  value: 17.23},
   {name:"North Dakota", value: 2.19},
   {name:"Ohio", value: 10.55},
   {name:"Oklahoma",  value: 8.76},
   {name:"Oregon" ,  value: 6.69},
   {name:"Pennsylvania", value: 12.08},
   {name:"Rhode Island", value: 11.99},
   {name:"South Carolina",  value: 18.34},
   {name:"South Dakota" ,  value: 3.16},
   {name:"Tennessee", value: 14.38},
   {name:"Texas", value: 19.65},
   {name:"Utah",  value: 3.27},
   {name:"Vermont" ,  value: 1.92},
   {name:"Virginia", value: 13.54},
   {name:"Washington", value: 7.89},
   {name:"West Virgina",  value: 5.61},
   {name:"Wisconsin" ,  value: 4.76},
   {name:"Wyoming", value: 2.82},
	];

	var margins = {top:50, right:0, bottom:90, left:50},
		width	= 1200 - margins.left - margins.right,
		height	= 680 - margins.top - margins.bottom;

  // var margin = {top: 50, right: 10, bottom: 90, left: 50},
  //   width = parseInt(d3.select('#chart').style('width'), 10),
  //   width = width - margin.left - margin.right,
  //   barHeight = 20,
  //   percent = d3.format('%');



	var svg = d3.select("body")
		.append("svg")
		.attr("width", width + margins.left +margins.right)
		.attr("height", height + margins.top + margins.bottom);


	var chart = svg.append("g")
		.attr("transform", "translate("+margins.left+","+margins.top + ")");


	var values = data.map(function(d){return d.value; });
	var names  = data.map(function(d){return d.name; });


	console.log(values,names,width,height);

	var y = d3.scale.linear()
		.domain([0, d3.max(values)-120])
		.range([height, 0]);

	var x = d3.scale.ordinal()
		.domain(names)
		.rangeRoundBands([0, width-55], .2);

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left")
		.ticks(15);

	chart.selectAll(".bar")
		 .data(data)
		 .enter()
		 .append("rect")
		 .attr("x", function(d){return x(d.name); })
		 .attr("y", function(d){return y(d.value); })
		 .attr("width", function(d){return x.rangeBand(); })
		 .attr("height", function(d){return height-y(d.value); })
		 .attr("class", "bar")

	svg.append("g")
		.attr("transform", "translate(" + margins.left + "," + margins.top + ")")
		.attr("class", "y axis")
		.call(yAxis);

		svg.append("g")
		.attr("transform", "translate(" + margins.left + "," + (height+margins.top) + ")")
        .attr("class", "x axis")
        .call(xAxis)
        .selectAll("text")  
            .style("text-anchor", "end")
            .attr("dx", "-.8em")
            .attr("dy", ".15em")
            .attr("transform", function(d) {
                return "rotate(-55)" 
                });


            var chart = $("#chart"),
                aspect = chart.width() / chart.height(),
                container = chart.parent();
                

                $(window).on("resize", function() {
            var targetWidth = container.width();
                chart.attr("width", targetWidth);
                chart.attr("height", Math.round(targetWidth / aspect));
                
                    }).trigger("resize");


    // svg.append("g")
    // .attr("transform", "translate(" + margins.left + "," + (height+margins.top) + ")")
    //     .attr("class", "x axis")
    //     .call(xAxis)
    //     .selectAll("text")  
    //         .style("text-anchor", "")
    //         .attr("dx", ".5em")
    //         .attr("dy", "-.6em")
    //         .attr("transform", function(d) {
    //             return "rotate(-90)" 
    //             });


</script>

</body></html>